library("pomdp")

CYBSEC_POMDP <- POMDP(
    states = c("Idle", "Receiving media through MQTT", "Setting up SystemD services", "Starting Weston", "Displaying media", "Error state", "Partial loss of system", "Complete loss of system"),
    actions = c("Monitor system", "Shutdown system", "Isolate system", "Display media", "Recover from error", "Intercept MQTT messaging", "Compromise Github repository" ,"Gain physical access to the device", "Exploit vulnerabilities in display","Exploit vulnerabilities in SSH"),
    observations = c("Normal operation", "Detected suspicious activity", "Detected system error", "Detected unusual media display", "Detected unauthorised access"),
    transition_prob = list(
        "Monitor system" = "uniform", 

        "Display media" = matrix(c(0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                   0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                   0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                   0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                   0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                   0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                   0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                   0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0
                                   ), nrow=8, byrow=TRUE), 

        "Isolate system" = matrix(c(0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                   0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                   0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                   0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                   0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                   0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                   0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                   0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0
                                   ), nrow=8, byrow=TRUE),
        
        "Shutdown system" = matrix(c(0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                   0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                   0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                   0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                   0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                   0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                   0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                   0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0
                                   ), nrow=8, byrow=TRUE),

        "Recover from error" = matrix(c(0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                        0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                        0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                        0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                        0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                        0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                        0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                        0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0
                                        ), nrow=8, byrow=TRUE),
        
        "Intercept MQTT messaging" = matrix(c(0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                              0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                              0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                              0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                              0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                              0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                              0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                              0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0
                                              ), nrow=8, byrow=TRUE),
        
        "Compromise Github repository" = matrix(c(0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                              0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                              0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                              0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                              0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                              0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                              0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                              0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0
                                              ), nrow=8, byrow=TRUE),

        "Gain physical access to the device" = matrix(c(0.0,0.0,0.0,0.0,0.0,0.0,0.5,0.5,
                                                        0.0,0.0,0.0,0.0,0.0,0.0,0.5,0.5,
                                                        0.0,0.0,0.0,0.0,0.0,0.0,0.5,0.5,
                                                        0.0,0.0,0.0,0.0,0.0,0.0,0.5,0.5,
                                                        0.0,0.0,0.0,0.0,0.0,0.0,0.5,0.5,
                                                        0.0,0.0,0.0,0.0,0.0,0.0,0.5,0.5,
                                                        0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,
                                                        0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0
                                                        ), nrow=8, byrow=TRUE),
        
        "Exploit vulnerabilities in display" = matrix(c(0.0,0.0,0.0,0.0,0.0,0.0,0.5,0.5,
                                                        0.0,0.0,0.0,0.0,0.0,0.0,0.5,0.5,
                                                        0.0,0.0,0.0,0.0,0.0,0.0,0.5,0.5,
                                                        0.0,0.0,0.0,0.0,0.0,0.0,0.5,0.5,
                                                        0.0,0.0,0.0,0.0,0.0,0.0,0.5,0.5,
                                                        0.0,0.0,0.0,0.0,0.0,0.0,0.5,0.5,
                                                        0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0,
                                                        0.0,0.0,0.0,0.0,0.0,0.0,0.0,1.0
                                                        ), nrow=8, byrow=TRUE),
        
        "Exploit vulnerabilities in SSH" = matrix(c(0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                              0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                              0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                              0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                              0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                              0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                              0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0,
                                              0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.166666667,0.0,0.0
                                              ), nrow=8, byrow=TRUE)
    ),
    observation_prob = list(
        "Monitor system" = matrix(c(0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20
                                    ), nrow=8, byrow=TRUE),
        "Isolate system" = matrix(c(0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20
                                    ), nrow=8, byrow=TRUE),
        "Shutdown system" = matrix(c(0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20
                                    ), nrow=8, byrow=TRUE),
        "Display media" = matrix(c(0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20
                                    ), nrow=8, byrow=TRUE),
        "Recover from error" = matrix(c(0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20
                                    ), nrow=8, byrow=TRUE),
        "Intercept MQTT messaging" = matrix(c(0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20
                                    ), nrow=8, byrow=TRUE),
        "Compromise Github repository" = matrix(c(0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20
                                    ), nrow=8, byrow=TRUE),
        "Gain physical access to the device" = matrix(c(0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20
                                    ), nrow=8, byrow=TRUE),
        "Exploit vulnerabilities in display" = matrix(c(0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20
                                    ), nrow=8, byrow=TRUE),
        "Exploit vulnerabilities in SSH" = matrix(c(0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20,
                                    0.20,0.20,0.20,0.20,0.20
                                    ), nrow=8, byrow=TRUE)
    ),
    reward = rbind(
        R_("Monitor system",  "Idle", "*", "*", 1),
        R_("Monitor system",  "Receiving media through MQTT", "*", "*", 1),
        R_("Monitor system",  "Setting up SystemD services",  "*", "*", 1),
        R_("Monitor system",  "Starting Weston", "*", "*", 1),
        R_("Monitor system",  "Displaying media", "*", "*", 1),
        R_("Monitor system",  "Error state", "*", "*", 1),
        R_("Monitor system",  "Partial loss of system", "*", "*", 1),
        R_("Monitor system",  "Complete loss of system", "*", "*", 1),

        R_("Reboot system",  "Idle",  "*", "*", 1),
        R_("Reboot system", "Receiving media through MQTT", "*", "*", 1),
        R_("Reboot system", "Setting up SystemD services",  "*", "*", 1),
        R_("Reboot system", "Starting Weston", "*", "*", 1),
        R_("Reboot system", "Displaying media", "*", "*", 1),
        R_("Reboot system", "Error state", "*", "*", 1),
        R_("Reboot system", "Partial loss of system", "*", "*", 1),
        R_("Reboot system", "Complete loss of system", "*", "*", 1),

        R_("Update system",  "Idle",  "*", "*", 1),
        R_("Update system",  "Receiving media through MQTT", "*", "*", 1),
        R_("Update system", "Setting up SystemD services",  "*", "*", 1),
        R_("Update system",  "Starting Weston", "*", "*", 1),
        R_("Update system",  "Displaying media", "*", "*", 1),
        R_("Update system",  "Error state", "*", "*", 1),
        R_("Update system",  "Partial loss of system", "*", "*", 1),
        R_("Update system",  "Complete loss of system", "*", "*", 1),

        R_("Display media", "Idle", "*", "*", 1),
        R_("Display media", "Receiving media through MQTT", "*", "*", 1),
        R_("Display media","Setting up SystemD services",  "*", "*", 1),
        R_("Display media","Starting Weston", "*", "*", 1),
        R_("Display media","Displaying media", "*", "*", 1),
        R_("Display media","Error state", "*", "*", 1),
        R_("Display media","Partial loss of system", "*", "*", 1),
        R_("Display media","Complete loss of system", "*", "*", 1),

        R_("Recover from error",  "Idle", "*", "*", 1),
        R_("Recover from error", "Receiving media through MQTT", "*", "*", 1),
        R_("Recover from error", "Setting up SystemD services",  "*", "*", 1),
        R_("Recover from error", "Starting Weston", "*", "*", 1),
        R_("Recover from error", "Displaying media", "*", "*", 1),
        R_("Recover from error", "Error state", "*", "*", 1),
        R_("Recover from error", "Partial loss of system", "*", "*", 1),
        R_("Recover from error", "Complete loss of system", "*", "*", 1),

        R_("Intercept MQTT messaging", "Idle", "*", "*", -100),
        R_("Intercept MQTT messaging","Receiving media through MQTT", "*", "*", -100),
        R_("Intercept MQTT messaging","Setting up SystemD services",  "*", "*", -100),
        R_("Intercept MQTT messaging","Starting Weston", "*", "*", -100),
        R_("Intercept MQTT messaging","Displaying media", "*", "*", -100),
        R_("Intercept MQTT messaging","Error state", "*", "*", -100),
        R_("Intercept MQTT messaging","Partial loss of system", "*", "*", -100),
        R_("Intercept MQTT messaging","Complete loss of system", "*", "*", -100),

        R_("Compromise Github repository", "Idle", "*", "*", -100),
        R_("Compromise Github repository", "Receiving media through MQTT", "*", "*", -100),
        R_("Compromise Github repository", "Setting up SystemD services",  "*", "*", -100),
        R_("Compromise Github repository", "Starting Weston", "*", "*", -100),
        R_("Compromise Github repository", "Displaying media", "*", "*", -100),
        R_("Compromise Github repository", "Error state", "*", "*", -100),
        R_("Compromise Github repository", "Partial loss of system", "*", "*", -100),
        R_("Compromise Github repository", "Complete loss of system", "*", "*", -100),

        R_("Gain physical access to the device", "Idle", "*", "*", -100),
        R_("Gain physical access to the device", "Receiving media through MQTT", "*", "*", -100),
        R_("Gain physical access to the device", "Setting up SystemD services",  "*", "*", -100),
        R_("Gain physical access to the device", "Starting Weston", "*", "*", -100),
        R_("Gain physical access to the device", "Displaying media", "*", "*", -100),
        R_("Gain physical access to the device", "Error state", "*", "*", -100),
        R_("Gain physical access to the device", "Partial loss of system", "*", "*", -100),
        R_("Gain physical access to the device", "Complete loss of system", "*", "*", -100),

        R_("Exploit vulnerabilities in display", "Idle", "*", "*", -100),
        R_("Exploit vulnerabilities in display","Receiving media through MQTT", "*", "*", -100),
        R_("Exploit vulnerabilities in display","Setting up SystemD services",  "*", "*", -100),
        R_("Exploit vulnerabilities in display","Starting Weston", "*", "*", -100),
        R_("Exploit vulnerabilities in display","Displaying media", "*", "*", -100),
        R_("Exploit vulnerabilities in display","Error state", "*", "*", -100),
        R_("Exploit vulnerabilities in display","Partial loss of system", "*", "*", -100),
        R_("Exploit vulnerabilities in display","Complete loss of system", "*", "*", -100),

        R_("Exploit vulnerabilities in SSH", "Idle", "*", "*", -100),
        R_("Exploit vulnerabilities in SSH","Receiving media through MQTT", "*", "*", -100),
        R_("Exploit vulnerabilities in SSH","Setting up SystemD services",  "*", "*", -100),
        R_("Exploit vulnerabilities in SSH","Starting Weston", "*", "*", -100),
        R_("Exploit vulnerabilities in SSH","Displaying media", "*", "*", -100),
        R_("Exploit vulnerabilities in SSH","Error state", "*", "*", -100),
        R_("Exploit vulnerabilities in SSH","Partial loss of system", "*", "*", -100),
        R_("Exploit vulnerabilities in SSH","Complete loss of system", "*", "*", -100)
    ),
    start = "uniform",
    discount = 0.75,
    name = "CYBSEC Problem POMDP"
)
sol <- solve_POMDP(CYBSEC_POMDP)
sol
